# 任务管理 - 记忆银行核心

## 🎯 当前主要任务

**为 VSCode Copy Code Block 扩展添加新功能**

### 主要需求

1. ✅ 添加 `${SELECTED_CODE}` 令牌支持 - 已完成
2. 🔄 添加 `${MARKDOWN_HEADING}` 令牌支持 - 进行中

## 📋 任务分解

### 阶段 1: 项目分析和设计 ✅

- [x] **T001**: 分析现有项目结构和功能
- [x] **T002**: 理解 VSCode 扩展 API 和架构
- [x] **T003**: 设计新令牌实现方案
- [x] **T004**: 创建记忆银行系统文档
- [x] **T005**: 制定开发计划和时间表

### 阶段 2: 核心功能开发 ✅

- [x] **T006**: 检查和分析现有源代码结构
  - 优先级: P0 (高)
  - 预计时间: 2 小时
  - 依赖: 无
  - 状态: 已完成 ✅
- [x] **T007**: 定位现有令牌处理逻辑
  - 优先级: P0 (高)
  - 预计时间: 1 小时
  - 依赖: T006
  - 状态: 已完成 ✅
- [x] **T008**: 实现选区检测功能
  - 优先级: P0 (高)
  - 预计时间: 3 小时
  - 依赖: T007
  - 状态: 已完成 ✅
- [x] **T009**: 添加 `${SELECTED_CODE}` 令牌到处理系统
  - 优先级: P0 (高)
  - 预计时间: 2 小时
  - 依赖: T008
  - 状态: 已完成 ✅
- [x] **T010**: 处理边界条件和错误情况
  - 优先级: P1 (中高)
  - 预计时间: 2 小时
  - 依赖: T009
  - 状态: 已完成 ✅
- [x] **T011**: 确保向后兼容性
  - 优先级: P0 (高)
  - 预计时间: 1 小时
  - 依赖: T010
  - 状态: 已完成 ✅

### 阶段 3: 新功能开发 - MARKDOWN_HEADING 令牌 🔄

- [ ] **T012**: 分析 Markdown 标题检测需求
  - 优先级: P0 (高)
  - 预计时间: 1 小时
  - 依赖: T011
  - 状态: 待开始
- [ ] **T013**: 实现 Markdown 标题检测逻辑
  - 优先级: P0 (高)
  - 预计时间: 2 小时
  - 依赖: T012
  - 状态: 待开始
- [ ] **T014**: 添加 `${MARKDOWN_HEADING}` 令牌到处理系统
  - 优先级: P0 (高)
  - 预计时间: 1 小时
  - 依赖: T013
  - 状态: 待开始
- [ ] **T015**: 处理边界条件和错误情况
  - 优先级: P1 (中高)
  - 预计时间: 1 小时
  - 依赖: T014
  - 状态: 待开始
- [ ] **T016**: 测试新令牌功能
  - 优先级: P1 (中高)
  - 预计时间: 2 小时
  - 依赖: T015
  - 状态: 待开始

### 阶段 4: 测试和验证 ⏳

- [ ] **T017**: 编写单元测试
  - 优先级: P1 (中高)
  - 预计时间: 3 小时
  - 依赖: T016
- [ ] **T018**: 进行集成测试
  - 优先级: P1 (中高)
  - 预计时间: 2 小时
  - 依赖: T017
- [ ] **T019**: 兼容性测试
  - 优先级: P0 (高)
  - 预计时间: 2 小时
  - 依赖: T018
- [ ] **T020**: 用户场景验证
  - 优先级: P1 (中高)
  - 预计时间: 2 小时
  - 依赖: T019

### 阶段 5: 文档和发布 ⏳

- [ ] **T021**: 更新 README 文档
  - 优先级: P2 (中)
  - 预计时间: 2 小时
  - 依赖: T020
- [ ] **T022**: 更新 package.json 配置说明
  - 优先级: P2 (中)
  - 预计时间: 1 小时
  - 依赖: T021
- [ ] **T023**: 准备 CHANGELOG
  - 优先级: P2 (中)
  - 预计时间: 0.5 小时
  - 依赖: T022
- [ ] **T024**: 版本发布准备
  - 优先级: P2 (中)
  - 预计时间: 1 小时
  - 依赖: T023

## 🚀 下一步行动

### 立即执行 (今天)

1. **T012**: 分析 Markdown 标题检测需求
2. **T013**: 实现 Markdown 标题检测逻辑

### 本周目标

- 完成阶段 3 的新功能开发任务 (T012-T016)
- 开始基本测试验证

### 下周计划

- 完成测试和验证阶段 (T017-T020)
- 完成文档更新和发布准备 (T021-T024)

## 📊 进度统计

**总任务数**: 24  
**已完成**: 11 (46%)  
**进行中**: 0 (0%)  
**待开始**: 13 (54%)

**预计总工时**: 33.5 小时  
**已用工时**: 19 小时  
**剩余工时**: 14.5 小时

## 🔍 关键决策点

### 已决定

- 使用 `vscode.TextEditor.selection` API 检测选区
- 保持现有 `${CODE}` 令牌行为不变
- 新令牌作为独立功能添加

### 待决定

- 是否需要对选中内容大小设置限制
- 是否同时添加其他选区相关令牌
- 是否需要新的配置选项

## ⚠️ 风险和阻塞

### 当前风险

- **兼容性风险**: 新功能可能影响现有配置
- **复杂度风险**: 多选区域处理可能比预期复杂

### 缓解措施

- 严格的向后兼容性测试
- 分阶段实现，优先核心功能

## 📝 备注和学习

### 技术要点

- VSCode 扩展开发模式
- TypeScript 类型系统应用
- 令牌替换系统设计

### 项目管理要点

- 记忆银行系统的有效性
- 任务分解和依赖管理
- 风险识别和预防
